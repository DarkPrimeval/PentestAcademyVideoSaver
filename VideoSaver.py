import requests
import re
from bs4 import BeautifulSoup

#Input your cookie
cookie = dict(SACSID='')



course_id = "" #Fill in the desired course id
url = 'https://www.pentesteracademy.com/course?id='
url += course_id
r = requests.get(url, cookies=cookie)
data = r.text
pattern = "video?id"
soup = BeautifulSoup(data, features="lxml")

#Retrieve the course video numbers and convert to the download link
videos = list()
for a_tag in soup.find_all('a'):
    if a_tag.get('href') is not None:
        if pattern in a_tag.get('href'):
            video = a_tag.get('href')
            video = re.sub("video", "accounting", video)
            if video not in videos:
                videos.append(video)
            else:
                pass
    else:
        pass


#Download the link and name with "1_Name_of_video_.mp4"
url = 'https://www.pentesteracademy.com'
count = 1
for link in videos:
    video_link = str()
    video_link = url + link
    r = requests.get(video_link, cookies=cookie)
    #Some videos have %26, URL encoded &, this will find and replace
    match = re.search(r"\w+[%]?\w+.mp4", r.url)
    name = match.group(0)
    name = re.sub("%26", "&", name)
    full_name = str(count) + "_" + name
    print("Downloading " + full_name)
    data = r.content
    with open(full_name, "wb") as f:
        f.write(data)
    print("Downloaded")
    count += 1

